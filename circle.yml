machine:
  xcode:
    version: "7.0"

dependencies:
  override:
    - sudo chown :wheel /Library/Developer/CoreSimulator/Profiles/Runtimes/iOS\ *.simruntime/Contents/Resources/RuntimeRoot/usr/lib/dyld_sim
    - ./scripts/import-certificates
    - brew update
    - brew install carthage
    - carthage bootstrap --use-submodules --platform Mac,iOS

# despite what circle ci says, xctool 0.2.3 cannot run
# ios simulator tests on iOS frameworks for whatever reason.
#
# See: https://github.com/facebook/xctool/issues/415
test:
  override:
    - carthage build --no-skip-current --use-submodules --platform Mac,iOS
    - rake test:ios
    - rake test:osx
