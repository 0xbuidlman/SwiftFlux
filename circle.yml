machine:
  xcode:
    version: "7.0"
  environment:
    LC_CTYPE: en_US.UTF-8

dependencies:
  override:
    - sudo chown :wheel /Library/Developer/CoreSimulator/Profiles/Runtimes/iOS\ *.simruntime/Contents/Resources/RuntimeRoot/usr/lib/dyld_sim
    - ./scripts/import-certificates
    - git submodule update --init --recursive
    - brew update
    - brew install carthage

# despite what circle ci says, xctool 0.2.3 cannot run
# ios simulator tests on iOS frameworks for whatever reason.
#
# See: https://github.com/facebook/xctool/issues/415
test:
  override:
    - carthage build --no-skip-current --platform Mac,iOS
    - rake test:ios
    - rake test:osx
